# クラシック音楽学習アプリ 要件定義書

## 1. 概要

### 1.1. アプリの目的
クラシック音楽が好きなユーザーをターゲットとし、ゲーム感覚で楽しみながら有名なクラシック音楽の名曲を学べるWebアプリケーションを提供する。曲名だけでなく、作曲家や楽曲の解説、トリビアといった付随情報も提供し、ユーザーの知的好奇心を満たすことを目指す。

### 1.2. ターゲットユーザー
*   クラシック音楽が好きな人
*   音楽の雑学やクイズが好きな人
*   有名な楽曲について学びたい人

## 2. 機能要件

### 2.1. クイズモード
1セット5〜30問のクイズに挑戦し、スコアを競うモード。

*   **クイズ形式**：以下の2種類から選択可能とする。
    1.  流れる曲を聴いて、4つの選択肢から正しい曲名を選ぶ。
    2.  表示された曲名を見て、4つの選択肢から正しい作曲家を選ぶ。

*   **ゲームフロー**
    1.  トップページで「クイズモード」を選択。
    2.  ニックネームを入力する。（初回のみ、もしくは毎回）
    3.  クイズ形式（上記1, 2）と出題範囲（作曲家）を選択する。
    4.  クイズ開始。
    5.  全問回答後、結果画面に遷移。

*   **結果表示**
    *   正解数（/N問）
    *   回答にかかった合計時間
    *   スコア（後述）

### 2.2. ランキング機能
クイズモードの結果をサーバーに記録し、スコアをランキング形式で表示する。

*   **記録する情報**
    *   ニックネーム（localStorageで前回入力した値を保持）
    *   スコア
    *   出題範囲（作曲家カテゴリ）
    *   達成日時

*   **スコアリング**
    *   正解数と回答時間から算出する。
    *   計算式： `スコア = (正解数 * 1000) - (回答時間[秒] * 10)`
        *   例：10問正解、30秒でクリアした場合 → (10 * 1000) - (30 * 10) = 9700点
        *   例： 8問正解、50秒でクリアした場合 → ( 8 * 1000) - (50 * 10) = 7500点

*   **ランキング表示**
    *   **作曲家別ランキング**: すべて、ベートーヴェン、モーツァルト、バッハなどから選択可能
    *   **表示タイプ**: 「今日のランキング」と「歴代トップ5」を切り替え可能
    *   **クイズ形式別**: 「曲 → 曲名」と「曲名 → 作曲家」で別々のランキングを表示
    *   上位3位にはメダル（🥇🥈🥉）を表示
    *   登録日時も表示

*   **クイズ結果画面**
    *   選択した作曲家カテゴリのランキングのみを表示
    *   「今日のランキング」を表示

### 2.3. 学習モード
クイズとは別に、じっくりと楽曲や作曲家の情報を学べるモード。

*   **形式**：フラッシュカード形式を採用。
    *   カードの表面に「音声プレーヤー」、裏面に「曲名と詳細情報」を表示する。
    *   ユーザーがカードをめくる動作で答え合わせができる。

*   **表示コンテンツ**：カードには以下の情報を含める。
    *   音声再生（Wikimedia Commonsの著作権フリー音源）
    *   曲名
    *   作曲家名
    *   ジャンル（交響曲、ピアノ曲、バレエ音楽など）
    *   楽曲の解説
    *   トリビア（豆知識）

*   **操作**
    *   矢印キー（←→）で前後のカードに移動
    *   スペースキーで表裏を切り替え、または音声の再生/一時停止
    *   裏面を表示中に次へ進んでも、次のカードは表面から開始

### 2.4. キーボードショートカット
*   **クイズ設定画面**: Ctrl+Enter（または Cmd+Enter）でクイズ開始
*   **クイズ画面**:
    *   デフォルトで左上の選択肢を選択
    *   十字キー（↑↓←→）で選択肢を移動（画面幅により1列/2列グリッドに対応）
    *   Enter キーで選択中の選択肢を選択して次の問題へ
    *   スペースキーで音声の再生/一時停止
    *   選択中の選択肢は視覚的に強調表示

## 3. 画面構成

1.  **トップページ**
    *   アプリタイトル「クラシック音楽学習ゲーム」を表示。
    *   「クイズモード」「学習モード」「ランキングを見る」へのナビゲーションボタンを配置。
2.  **クイズ設定画面**
    *   ニックネーム入力欄（前回入力した値を自動入力）。
    *   クイズ形式の選択肢（曲→曲名、曲名→作曲家）。
    *   出題範囲の選択肢（すべて、ベートーヴェン、モーツァルトなど）。
    *   問題数の選択肢（5問、10問、30問、すべて）。
    *   「スタート」ボタン。
    *   ヒント表示: "Ctrl+Enter でクイズ開始"
3.  **クイズ画面**
    *   問題（音声プレーヤー or 曲名）を薄い灰色の背景に表示。
    *   選択肢（4つ）をボタンで表示（選択中の選択肢を視覚的に強調）。
    *   現在の問題数（例：3/10）と経過時間を表示。
4.  **結果画面**
    *   正解数、回答時間、スコアを表示。
    *   回答詳細: 各問題の曲名、あなたの回答、正解を一覧表示。
    *   「ランキングを見る」「トップに戻る」ボタンを配置。
5.  **ランキング画面**
    *   作曲家カテゴリ選択ドロップダウン（すべて、各作曲家）。
    *   表示タイプ選択ドロップダウン（今日のランキング、歴代トップ5）。
    *   順位、ニックネーム、スコア、登録日時を一覧で表示。
    *   トップ3にはメダル表示（🥇🥈🥉）。
6.  **学習モード画面**
    *   フラッシュカード形式で楽曲や作曲家の情報を表示。
    *   「次へ」「前へ」などのナビゲーション。
    *   矢印キーとスペースキーでの操作をサポート。

## 4. 非機能要件

### 4.1. デザイン
*   全体的に**シンプルでスタイリッシュ**なデザインを採用する。
*   白やグレーを基調とし、アクセントカラー（インディゴ）で操作性を高める。
*   Favicon: 音符をモチーフにしたデザイン（🎵）。

### 4.2. 対応デバイス
*   PC、スマートフォンのブラウザに対応するレスポンシブデザインとする。

### 4.3. 多言語対応
*   日本語と英語の2言語に対応。
*   トップページで言語選択が可能。
*   楽曲データ、作曲家名、UI表示が選択した言語で表示される。

### 4.4. 音声データ
*   Wikimedia Commonsから著作権フリーの音源を使用。
*   パブリックドメインまたはCreative Commonsライセンスの音源のみ使用。
