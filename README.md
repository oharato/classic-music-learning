# å›½æ——å­¦ç¿’ã‚¢ãƒ—ãƒª

ã‚²ãƒ¼ãƒ æ„Ÿè¦šã§æ¥½ã—ã¿ãªãŒã‚‰ä¸–ç•Œã®å›½æ——ã‚’æš—è¨˜ã§ãã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

## âœ¨ ä¸»ãªæ©Ÿèƒ½

- **ã‚¯ã‚¤ã‚ºãƒ¢ãƒ¼ãƒ‰**: å›½æ——ã‚’è¦‹ã¦å›½åã‚’é¸ã¶ã€ã¾ãŸã¯å›½åã‚’è¦‹ã¦å›½æ——ã‚’é¸ã¶2ç¨®é¡ã®ã‚¯ã‚¤ã‚ºå½¢å¼ã§ã€ã‚¹ã‚³ã‚¢ã‚’ç«¶ã„ã¾ã™ã€‚
  - ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆå¯¾å¿œ: Ctrl+Enter ã§ã‚¯ã‚¤ã‚ºé–‹å§‹ã€çŸ¢å°ã‚­ãƒ¼ã§é¸æŠã€Enterã§å›ç­”é€ä¿¡
  - é›£æ˜“åº¦è¨­å®š: ç°¡å˜ï¼ˆ4æŠï¼‰ã€æ™®é€šï¼ˆ6æŠï¼‰ã€é›£ã—ã„ï¼ˆ8æŠï¼‰
  - å‡ºé¡Œç¯„å›²è¨­å®š: å…¨ä¸–ç•Œã€ã‚¢ãƒ•ãƒªã‚«ã€ã‚¢ã‚¸ã‚¢ã€ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘ã€åŒ—ã‚¢ãƒ¡ãƒªã‚«ã€å—ã‚¢ãƒ¡ãƒªã‚«ã€ã‚ªã‚»ã‚¢ãƒ‹ã‚¢
  - ç”»åƒãƒ—ãƒªãƒ­ãƒ¼ãƒ‰: æ¬¡ã®å•é¡Œã®ç”»åƒã‚’äº‹å‰èª­ã¿è¾¼ã¿ã—ã€ã‚¹ãƒ ãƒ¼ã‚ºãªå•é¡Œç§»è¡Œã‚’å®Ÿç¾  
  
- **å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰**: ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰å½¢å¼ã§ã€å›½æ——ã€å›½åã€é¦–éƒ½ã€å¤§é™¸ã€åœ°å›³ã€æ¦‚è¦ã€å›½æ——ã®ç”±æ¥ã‚’ã˜ã£ãã‚Šå­¦ç¿’ã§ãã¾ã™ã€‚
  - ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ: çŸ¢å°ã‚­ãƒ¼ã§å‰å¾Œç§»å‹•ã€ã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼ã§è¡¨è£åˆ‡ã‚Šæ›¿ãˆ
  - é•·æ–‡ã¯ãƒã‚¦ã‚¹ãƒ›ãƒãƒ¼/ã‚¿ãƒƒãƒã§ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—è¡¨ç¤º
  - ç”»åƒã®æœ€é©åŒ–: å³åº§ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹é«˜é€Ÿè¡¨ç¤º  
  
- **ãƒ©ãƒ³ã‚­ãƒ³ã‚°æ©Ÿèƒ½**: ã‚¯ã‚¤ã‚ºã§ç²å¾—ã—ãŸã‚¹ã‚³ã‚¢ã‚’åœ°åŸŸåˆ¥ãƒ»æœŸé–“åˆ¥ãƒ»å½¢å¼åˆ¥ã§ç«¶ã„åˆãˆã¾ã™ã€‚
  - åœ°åŸŸåˆ¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°: å…¨ä¸–ç•Œã€ã‚¢ãƒ•ãƒªã‚«ã€ã‚¢ã‚¸ã‚¢ã€ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘ã€åŒ—ã‚¢ãƒ¡ãƒªã‚«ã€å—ã‚¢ãƒ¡ãƒªã‚«ã€ã‚ªã‚»ã‚¢ãƒ‹ã‚¢
  - æœŸé–“åˆ¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°: æ—¥æ¬¡ãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆå½“æ—¥ã®ã‚¹ã‚³ã‚¢ï¼‰ã€å…¨æœŸé–“ãƒˆãƒƒãƒ—5
  - å½¢å¼åˆ¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°: å›½æ——â†’å›½åã€å›½åâ†’å›½æ——ã§åˆ¥ã€…ã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°
  - ãƒˆãƒƒãƒ—3ã«ã¯ãƒ¡ãƒ€ãƒ«è¡¨ç¤ºï¼ˆğŸ¥‡ğŸ¥ˆğŸ¥‰ï¼‰
  - ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã®è‡ªå‹•ä¿å­˜ï¼ˆlocalStorageï¼‰

- **å¤šè¨€èªå¯¾å¿œ**: æ—¥æœ¬èªãƒ»è‹±èªã®åˆ‡ã‚Šæ›¿ãˆã«å¯¾å¿œ

## ğŸ› ï¸ ä½¿ç”¨æŠ€è¡“

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- [Vue.js](https://vuejs.org/) (v3, Composition API)
- [Vite](https://vitejs.dev/)
- [Pinia](https://pinia.vuejs.org/)
- [Vue Router](https://router.vuejs.org/)
- [Tailwind CSS](https://tailwindcss.com/)

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- **å†åˆ©ç”¨å¯èƒ½ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**: DRYåŸå‰‡ã«åŸºã¥ã„ãŸè¨­è¨ˆ
  - å…±é€šUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ: LanguageSelector, LoadingSpinner, ErrorMessage, AppButton
  - ã‚¯ã‚¤ã‚ºè¨­å®šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ: RegionSelector, QuizFormatSelector
  - å­¦ç¿’ç”¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ: FlagCard, CountryDetailCard
- **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³**: ãƒ¢ãƒã‚¤ãƒ«ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã®è¨­è¨ˆ
  - ã‚¹ãƒãƒ›ã¨PCã§æœ€é©åŒ–ã•ã‚ŒãŸç•°ãªã‚‹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
  - ãƒ©ãƒ³ã‚­ãƒ³ã‚°: PCç‰ˆã¯ãƒ†ãƒ¼ãƒ–ãƒ«ã€ã‚¹ãƒãƒ›ç‰ˆã¯ã‚«ãƒ¼ãƒ‰å½¢å¼
  - ãƒ•ã‚©ãƒ¼ãƒ : ç”»é¢ã‚µã‚¤ã‚ºã«å¿œã˜ãŸé©åˆ‡ãªã‚µã‚¤ã‚ºã¨ã‚¹ãƒšãƒ¼ã‚·ãƒ³ã‚°
  - ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ã®ç”»é¢å†…è¡¨ç¤º
- **CI/CD**: GitHub Actions ã«ã‚ˆã‚‹è‡ªå‹•ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- [Hono](https://hono.dev/)
- [Cloudflare Pages Functions](https://developers.cloudflare.com/pages/functions/)
- [Cloudflare D1](https://developers.cloudflare.com/d1/) (ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹)

### ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹
- [Wikipedia](https://www.wikipedia.org/) (å›½æ——ç”»åƒã€åœ°å›³ç”»åƒã€å›½æ——ã®ç”±æ¥ã€æ¦‚è¦ãªã©)
  - ãƒ‡ãƒ¼ã‚¿å–å¾—ã«ã¯ [wikijs](https://www.npmjs.com/package/wikijs) ã‚’ä½¿ç”¨
- [Wikidata](https://www.wikidata.org/wiki/Wikidata:Main_Page) (é¦–éƒ½æƒ…å ±: P36ã€å¤§é™¸æƒ…å ±ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: P30)
  - Wikidata APIã‚’ç›´æ¥ä½¿ç”¨ã—ã€è¨€èªåˆ¥ãƒ©ãƒ™ãƒ«ã‚’å–å¾—
  - å¤§é™¸æƒ…å ±ã¯ä¸»ã«Wikipediaã®ã‚«ãƒ†ã‚´ãƒªï¼ˆ`Category:ã€‡ã€‡ã®å›½` / `Countries in ã€‡ã€‡`ï¼‰ã‹ã‚‰å–å¾—ã—ã€å–å¾—ã§ããªã„å ´åˆã®ã¿Wikidataã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯

## ğŸš€ ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®å®Ÿè¡Œæ–¹æ³•

### 1. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
npm install
```

### 2. å›½ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆ
Wikipedia ã¨ Wikidata ã‹ã‚‰å›½æ——ã‚„å›½ã®æƒ…å ±ã‚’å–å¾—ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒä½¿ç”¨ã™ã‚‹ `public/countries.ja.json` ã¨ `public/countries.en.json` ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
**æ³¨æ„**: ã“ã®å‡¦ç†ã¯å¤–éƒ¨APIã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã€æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼ˆç´„30åˆ†ã€œ1æ™‚é–“ï¼‰ã€‚

1.  **å›½åï¼å›½æ——ãƒšãƒ¼ã‚¸ãƒãƒƒãƒ”ãƒ³ã‚°ã®ç”Ÿæˆï¼ˆä»»æ„ï¼‰**
 ```bash
 npx tsx scripts/extract-flag-page-names.mts
 ```
 ... (truncated for brevity in this query; update uses full README content) ...


## ï¿½ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
.
â”œâ”€â”€ functions/       # Cloudflare Pages Functions (ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API)
â”œâ”€â”€ migrations/      # D1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ public/          # é™çš„ãƒ•ã‚¡ã‚¤ãƒ« (å›½ãƒ‡ãƒ¼ã‚¿JSONã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸå›½æ——ãƒ»åœ°å›³ç”»åƒãªã©)
â”‚   â”œâ”€â”€ flags/       # ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸå›½æ——ç”»åƒ
â”‚   â””â”€â”€ maps/        # ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸåœ°å›³ç”»åƒ
â”œâ”€â”€ scripts/         # ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆãªã©ã®ãƒãƒƒãƒã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â””â”€â”€ src/
    â”œâ”€â”€ assets/      # ç”»åƒãªã©ã®ã‚¢ã‚»ãƒƒãƒˆ
    â”œâ”€â”€ components/  # å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    â”œâ”€â”€ router/      # Vue Router ã®è¨­å®š
    â”œâ”€â”€ server/      # (ç¾åœ¨ã¯æœªä½¿ç”¨) Honoã‚µãƒ¼ãƒãƒ¼ã®æ—§æ ¼ç´å ´æ‰€
    â”œâ”€â”€ store/       # Pinia ã‚¹ãƒˆã‚¢ (çŠ¶æ…‹ç®¡ç†)
    â”œâ”€â”€ views/       # å„ç”»é¢ã®Vueã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    â”œâ”€â”€ App.vue      # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ«ãƒ¼ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    â”œâ”€â”€ main.ts      # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
    â””â”€â”€ style.css    # ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚¿ã‚¤ãƒ«
```  


---

## Cloudflare Pages ç”¨ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®š

### èƒŒæ™¯
- ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã‚ã£ãŸ `public/_headers` ã¯ Netlify å›ºæœ‰ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã™ã€‚Cloudflare Pages ã§ã¯è‡ªå‹•çš„ã«é©ç”¨ã•ã‚Œãªã„ãŸã‚ã€åŠ¹æœãŒã‚ã‚Šã¾ã›ã‚“ã€‚Netlify ç”¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã€Cloudflare å´ã§åŒç­‰ã®è¨­å®šã‚’è¡Œã£ã¦ãã ã•ã„ã€‚

### æ¨å¥¨ã™ã‚‹å®Ÿè£…é †ï¼ˆå„ªå…ˆåº¦é †ï¼‰
1. ã‚ªãƒªã‚¸ãƒ³ï¼ˆãƒ“ãƒ«ãƒ‰å‡ºåŠ›ï¼S3 ç­‰ï¼‰ã§ Cache-Control ã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä»˜ä¸ã™ã‚‹ï¼ˆæœ€ã‚‚ç°¡å˜ã§ç¢ºå®Ÿï¼‰ã€‚
2. Cloudflare ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã® Rules â†’ Transform Rules / Response Header Modification ã§ãƒ‘ã‚¹ã”ã¨ã«ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¿½åŠ ãƒ»ä¸Šæ›¸ãã™ã‚‹ã€‚
3. Cloudflare Workers ã‚’ä½¿ã£ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ã‘å–ã‚Šãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æ›¸ãæ›ãˆã‚‹ï¼ˆç´°ã‹ã„åˆ¶å¾¡ãŒå¿…è¦ãªå ´åˆï¼‰ã€‚

### æ—¢å­˜ã® `_headers` ã«æ›¸ã‹ã‚Œã¦ã„ãŸãƒ«ãƒ¼ãƒ«ã¨ Cloudflare ã§ã®å¯¾å¿œä¾‹
- /assets/*
  - Cache-Control: public, max-age=31536000, immutable
- /flags/*, /maps/*
  - Cache-Control: public, max-age=2592000
- /*.json
  - Cache-Control: public, max-age=86400
- /sw.js
  - Cache-Control: public, max-age=3600

- å…¨ãƒšãƒ¼ã‚¸ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ï¼‰
  - X-Frame-Options: DENY
  - X-Content-Type-Options: nosniff
  - Referrer-Policy: strict-origin-when-cross-origin
  - Permissions-Policy: geolocation=(), microphone=(), camera=()
  - X-XSS-Protection: 1; mode=block ï¼ˆæ³¨ï¼šå¤šãã®ãƒ¢ãƒ€ãƒ³ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯éæ¨å¥¨ã§ã‚ã‚Šã€Content-Security-Policyï¼ˆCSPï¼‰ã‚’ä½µç”¨ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ï¼‰

### Cloudflare ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã®æ‰‹é †ï¼ˆç°¡æ˜“ï¼‰
1. https://dash.cloudflare.com/ ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã€Pages ã‚µã‚¤ãƒˆã‚’é¸æŠã—ã¾ã™ã€‚
2. Rules â†’ Transform Rulesï¼ˆã¾ãŸã¯ Response Header Modificationï¼‰ã‚’é–‹ãã¾ã™ã€‚
3. æ¡ä»¶ï¼ˆä¾‹: Path starts with /assets/ï¼‰ã‚’ä½œæˆã—ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¿½åŠ ï¼ä¸Šæ›¸ãã—ã¾ã™ã€‚
4. ã‚ˆã‚ŠæŸ”è»Ÿãªåˆ¶å¾¡ãŒå¿…è¦ãªã‚‰ Worker ã‚’ä½œæˆã—ã¦ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å·®ã—æ›¿ãˆã‚‹å‡¦ç†ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

### Cloudflare Worker ã®ç°¡å˜ãªã‚µãƒ³ãƒ—ãƒ«ï¼ˆå‚è€ƒï¼‰
ä¸‹è¨˜ã¯ã‚ªãƒªã‚¸ãƒ³ã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å¯¾ã—ã¦ãƒ‘ã‚¹ã”ã¨ã« Cache-Control ã‚’ä¸Šæ›¸ãã—ã€å…¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¿½åŠ ã™ã‚‹æœ€å°é™ã®ä¾‹ã§ã™ã€‚å¿…è¦ã«å¿œã˜ã¦ README ã«è¼‰ã›ã‚‹ã‹ã€ãƒªãƒã‚¸ãƒˆãƒªã« scripts/worker.js ã¨ã—ã¦è¿½åŠ ã—ã¦ãã ã•ã„ã€‚

addEventListener("fetch", event => {
  event.respondWith(handle(event.request));
});

async function handle(request) {
  const url = new URL(request.url);
  const res = await fetch(request);
  const headers = new Headers(res.headers);

  if (url.pathname.startsWith("/assets/")) {
    headers.set("Cache-Control", "public, max-age=31536000, immutable");
  } else if (url.pathname.startsWith("/flags/") || url.pathname.startsWith("/maps/")) {
    headers.set("Cache-Control", "public, max-age=2592000");
  } else if (url.pathname.endsWith(".json")) {
    headers.set("Cache-Control", "public, max-age=86400");
  } else if (url.pathname === "/sw.js") {
    headers.set("Cache-Control", "public, max-age=3600");
  }

  headers.set("X-Frame-Options", "DENY");
  headers.set("X-Content-Type-Options", "nosniff");
  headers.set("Referrer-Policy", "strict-origin-when-cross-origin");
  headers.set("Permissions-Policy", "geolocation=(), microphone=(), camera=()");
  headers.set("X-XSS-Protection", "1; mode=block");

  return new Response(res.body, {
    status: res.status,
    statusText: res.statusText,
    headers
  });
}

### æ³¨æ„ç‚¹
- Cloudflare ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®šï¼ˆEdge Cache TTLã€Cache Rulesï¼‰ã¨ã‚ªãƒªã‚¸ãƒ³å´ã® Cache-Control ã®çµ„åˆã›ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ã‚ªãƒªã‚¸ãƒ³ã§æ­£ã—ãè¨­å®šã™ã‚‹ã®ãŒæœ€ã‚‚ç¢ºå®Ÿã§ã™ã€‚
- X-XSS-Protection ã¯å¤šãã®æœ€æ–°ãƒ–ãƒ©ã‚¦ã‚¶ã§éæ¨å¥¨ã§ã™ã€‚å¯èƒ½ã§ã‚ã‚Œã° CSP ã‚’å°å…¥ã—ã¦ãã ã•ã„ã€‚
